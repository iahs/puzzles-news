<div class="pure-g-r">

    <aside class="pure-u-1-1" style="padding:20px" ng-show="queryTags.length > 0">
        <span>Displaying posts with one or more of the following tags (click tag to remove)</span><br/>
        <a ng-repeat="tag in queryTags" ng-click="removeQueryTag(tag)" class="pure-button pure-button-active button-small">
            {{ tag.name }}
        </a>
    </aside>
    <div class="pure-u-1-3">
        <h3>Search for tags</h3>
        <form class="pure-form">
            <input type="text" ng-model="tagSearch" placeholder="Search for tag">
        </form>
    </div>
    <div class="pure-u-2-3">
        <div class="padded">
            <a ng-repeat="tag in tags | filter:tagSearch | limitTo:15" ng-click="addQueryTag(tag)" class="pure-button button-xsmall">
                {{ tag.name }}
            </a>
        </div>

    </div>

</div>

<form ng-submit="search()" class="pure-form">
    <input ng-model="search.query" class="pure-input-1" placeholder="Fulltext search"/>
    <input type="submit" class="pure-button pure-button-primary pure-u-1" value="Search"/>
</form>

<div ng-repeat="post in posts" id="post-{{ post.id }}">
    <h3>
        <span ng-click="expandPost(post.id, post.pos)" slide-toggle="#full-post-{{post.id}}" ng-hide="post.expanded" class="truncated-post">{{ post.title | unescape }} ({{ post.clicks || 0 }})</span>
        <a href="{{post.permalink}}" target="_blank" ng-click="expandPost(post.id, post.pos)" ng-show="post.expanded">{{ post.title | unescape }} ({{ post.clicks || 0 }})</a>
    </h3>
    <a ng-repeat="tag in post.tags" ng-click="showTag(tag)" class="pure-button button-xsmall">{{ tag.name }}</a>
    <div ng-hide="post.expanded" ng-click="expandPost(post.id, post.pos)" class="truncated-post" slide-toggle="#full-post-{{post.id}}">
        <p>{{ post.body | unescape | truncate:maxPostLength}}<i ng-if="post.body.length > maxPostLength">Click to expand</i></p>
    </div>
    <div id="full-post-{{post.id}}" class="slideable" duration=".5s">
        <p>{{ post.body | unescape}}</p>
    </div>
</div>

